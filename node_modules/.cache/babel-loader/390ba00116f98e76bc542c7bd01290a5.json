{"ast":null,"code":"import { put, delay } from 'redux-saga/effects';\nimport { logoutSucceded, logout, authStart, authSuccess, authFailed, checkAuthTimeOut as authTimeOut } from '../actions/index';\nimport axios from 'axios';\nexport function* logoutSaga(action) {\n  yield localStorage.removeItem('token');\n  yield localStorage.removeItem('expirationDate');\n  yield localStorage.removeItem('userID');\n  yield put(logoutSucceded());\n}\nexport function* checkAuthTimeOut(action) {\n  yield delay(action.expirationTime * 1000);\n  yield put(logout());\n}\nexport function* addUserSaga(action) {\n  yield put(authStart());\n  const authData = {\n    email: action.email,\n    password: action.password,\n    returnSecureToken: true\n  };\n  let url = action.isSignup ? 'https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyCXyYykiJQjUafDFB18wiFqDXo21AdZ6L8' : 'https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyCXyYykiJQjUafDFB18wiFqDXo21AdZ6L8';\n  const response = yield axios.post(url, authData);\n  const expirationDate = new Date(new Date().getTime() + response.data.expiresIn * 1000);\n  localStorage.setItem('token', response.data.idToken);\n  localStorage.setItem('expirationDate', expirationDate);\n  localStorage.setItem('userID', response.data.localId);\n  yield put(authSuccess(response.data.idToken, response.data.localId));\n  yield put(authTimeOut(response.data.expiresIn));\n  yield put(authFailed(e.response.data.error));\n}","map":{"version":3,"sources":["/Users/diogosilva/Desktop/react-complete-guide/the-burguer-builder/src/store/sagas/auth.js"],"names":["put","delay","logoutSucceded","logout","authStart","authSuccess","authFailed","checkAuthTimeOut","authTimeOut","axios","logoutSaga","action","localStorage","removeItem","expirationTime","addUserSaga","authData","email","password","returnSecureToken","url","isSignup","response","post","expirationDate","Date","getTime","data","expiresIn","setItem","idToken","localId","e","error"],"mappings":"AAAA,SAASA,GAAT,EAAcC,KAAd,QAA2B,oBAA3B;AACA,SAASC,cAAT,EAAyBC,MAAzB,EAAiCC,SAAjC,EAA4CC,WAA5C,EAAyDC,UAAzD,EAAqEC,gBAAgB,IAAIC,WAAzF,QAA4G,kBAA5G;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAO,UAAUC,UAAV,CAAqBC,MAArB,EAA6B;AAChC,QAAMC,YAAY,CAACC,UAAb,CAAwB,OAAxB,CAAN;AACA,QAAMD,YAAY,CAACC,UAAb,CAAwB,gBAAxB,CAAN;AACA,QAAMD,YAAY,CAACC,UAAb,CAAwB,QAAxB,CAAN;AACA,QAAMb,GAAG,CAACE,cAAc,EAAf,CAAT;AACH;AAED,OAAO,UAAUK,gBAAV,CAA2BI,MAA3B,EAAmC;AACtC,QAAMV,KAAK,CAACU,MAAM,CAACG,cAAP,GAAwB,IAAzB,CAAX;AACA,QAAMd,GAAG,CAACG,MAAM,EAAP,CAAT;AACH;AAED,OAAO,UAAUY,WAAV,CAAsBJ,MAAtB,EAA8B;AACjC,QAAMX,GAAG,CAACI,SAAS,EAAV,CAAT;AACA,QAAMY,QAAQ,GAAG;AACbC,IAAAA,KAAK,EAAEN,MAAM,CAACM,KADD;AAEbC,IAAAA,QAAQ,EAAEP,MAAM,CAACO,QAFJ;AAGbC,IAAAA,iBAAiB,EAAE;AAHN,GAAjB;AAMA,MAAIC,GAAG,GAAGT,MAAM,CAACU,QAAP,GACN,mHADM,GAEN,uGAFJ;AAIA,QAAMC,QAAQ,GAAG,MAAMb,KAAK,CAACc,IAAN,CAAWH,GAAX,EAAgBJ,QAAhB,CAAvB;AAEA,QAAMQ,cAAc,GAAG,IAAIC,IAAJ,CAAS,IAAIA,IAAJ,GAAWC,OAAX,KAAuBJ,QAAQ,CAACK,IAAT,CAAcC,SAAd,GAA0B,IAA1D,CAAvB;AACAhB,EAAAA,YAAY,CAACiB,OAAb,CAAqB,OAArB,EAA8BP,QAAQ,CAACK,IAAT,CAAcG,OAA5C;AACAlB,EAAAA,YAAY,CAACiB,OAAb,CAAqB,gBAArB,EAAuCL,cAAvC;AACAZ,EAAAA,YAAY,CAACiB,OAAb,CAAqB,QAArB,EAA+BP,QAAQ,CAACK,IAAT,CAAcI,OAA7C;AAEA,QAAM/B,GAAG,CAACK,WAAW,CAACiB,QAAQ,CAACK,IAAT,CAAcG,OAAf,EAAwBR,QAAQ,CAACK,IAAT,CAAcI,OAAtC,CAAZ,CAAT;AACA,QAAM/B,GAAG,CAACQ,WAAW,CAACc,QAAQ,CAACK,IAAT,CAAcC,SAAf,CAAZ,CAAT;AAEA,QAAM5B,GAAG,CAACM,UAAU,CAAC0B,CAAC,CAACV,QAAF,CAAWK,IAAX,CAAgBM,KAAjB,CAAX,CAAT;AACH","sourcesContent":["import { put, delay } from 'redux-saga/effects';\nimport { logoutSucceded, logout, authStart, authSuccess, authFailed, checkAuthTimeOut as authTimeOut } from '../actions/index';\nimport axios from 'axios';\n\nexport function* logoutSaga(action) {\n    yield localStorage.removeItem('token');\n    yield localStorage.removeItem('expirationDate');\n    yield localStorage.removeItem('userID');\n    yield put(logoutSucceded());\n}\n\nexport function* checkAuthTimeOut(action) {\n    yield delay(action.expirationTime * 1000);\n    yield put(logout());\n}\n\nexport function* addUserSaga(action) {\n    yield put(authStart());\n    const authData = {\n        email: action.email,\n        password: action.password,\n        returnSecureToken: true\n    };\n\n    let url = action.isSignup ?\n        'https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyCXyYykiJQjUafDFB18wiFqDXo21AdZ6L8' :\n        'https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyCXyYykiJQjUafDFB18wiFqDXo21AdZ6L8';\n\n    const response = yield axios.post(url, authData);\n    \n    const expirationDate = new Date(new Date().getTime() + response.data.expiresIn * 1000);\n    localStorage.setItem('token', response.data.idToken);\n    localStorage.setItem('expirationDate', expirationDate);\n    localStorage.setItem('userID', response.data.localId);\n\n    yield put(authSuccess(response.data.idToken, response.data.localId));\n    yield put(authTimeOut(response.data.expiresIn));\n\n    yield put(authFailed(e.response.data.error));\n}"]},"metadata":{},"sourceType":"module"}